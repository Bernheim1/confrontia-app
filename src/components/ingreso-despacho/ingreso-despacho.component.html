<div *ngFor="let item of items; let i = index;">
  <section
  class="w-full mx-auto px-6 py-8
         bg-surface-card dark:bg-primary-800
         shadow-sm
         animate-scale-up"
>
  <!-- Header -->
  <header class="mb-6">
  <button
    *ngIf="masivo"
    type="button"
    aria-label="Eliminar"
    (click)="deteleDespacho(i)"
    class="absolute top-3 right-3 flex items-center justify-center
          w-8 h-8 rounded-full
          text-gray-500 hover:text-gray-800
          hover:bg-gray-200 transition"
  >
    ✕
  </button>
    <h1 class="text-3xl md:text-4xl font-semibold text-ink-light dark:text-ink-dark tracking-tight">
      Primer despacho
    </h1>

    <p class="mt-2 max-w-3xl text-base text-ink-muted dark:text-primary-200" >
      Redacte el texto base del despacho. Luego podrá reutilizarlo para generar
      cédulas, mandamientos y notificaciones procesales.
    </p>
  </header>

  <!-- Editor -->
  <div class="bg-surface-light dark:bg-primary-900 border border-primary-200 dark:border-primary-700 rounded-lg">
    <div class="px-4 py-2 border-b border-primary-200 dark:border-primary-700 text-sm font-medium text-ink-muted dark:text-primary-300">
      Texto del despacho
    </div>

    <textarea
      [(ngModel)]="item.primerDespacho"
      rows="16"
      placeholder="Escriba aquí el despacho…"
      class="w-full px-4 py-4
             bg-transparent
             text-[15px] leading-relaxed
             text-ink-light dark:text-ink-dark
             placeholder:text-primary-300
             resize-none outline-none"
    ></textarea>
      
    </div>
    <div class="d-flex flex-column flex-sm-column flex-md-row justify-content-between align-items-stretch align-items-md-center mt-3">
          <!-- Toggle Selector -->
          <div *ngIf="!masivo" class="toggle-selector mb-2 mb-md-0">
                <button 
                  class="toggle-btn bg-surface-light dark:bg-primary-900 text-ink-light dark:text-ink-dark" 
                  [class.active]="tipoSalida === 1"
                  type="button" 
                  (click)="seleccionTipoSalida(0, tipoCedula.TrasladoDemanda)">
                  Cédula
                </button>
                
                <button 
                  class="toggle-btn bg-surface-light dark:bg-primary-900 text-ink-light dark:text-ink-dark" 
                  [class.active]="tipoSalida === 2"
                  type="button" 
                  (click)="seleccionTipoSalida(1, tipoMandamiento.IntimacionPago)">
                  Mandamiento
                </button>
          </div>

            <!-- Button -->
            <button *ngIf="!masivo" class="w-full text-white bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800" type="button" (click)="onSubmit()" style="min-width: 150px;">
              Ingresar
              <fa-icon [icon]="faArrowRight"></fa-icon>
            </button>
          </div>
  </section>
  <hr>
</div>
<div *ngIf="!masivo" class="bg-secondary rounded-xl border-2 border-secondary shadow">
    <!-- <button
      type="button"
      (click)="addDespacho()"
      class="bg-surface-card text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 w-full text-center rounded-lg px-4 py-3 text-lg font-semibold
             border border-white text-ink-light dark:text-ink-dark  transition-colors duration-200">
      + Agregar Ingreso
    </button> -->
    <button (click)="addDespacho()" class="fixed bottom-6 right-6 bg-primary-600 hover:bg-primary-700 text-white w-20
     h-20 rounded-full shadow-xl flex items-center justify-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
      </svg>
    </button>
</div>

<div *ngIf="masivo" class="floating-container">
  
  <div class="floating-actions">
    <button 
      class="btn btn-selector btn-outline-primary" 
      type="button" 
      (click)="addDespacho()">
      + Agregar ingreso
    </button>

    <div class="toggle-selector btn-selector">
            <button 
              class="toggle-btn" 
              [class.active]="tipoSalida === 1"
              type="button" 
              (click)="seleccionTipoSalida(0, tipoCedula.TrasladoDemanda)">
              Cédula
            </button>
            
            <button 
              class="toggle-btn" 
              [class.active]="tipoSalida === 2"
              type="button" 
              (click)="seleccionTipoSalida(1, tipoMandamiento.IntimacionPago)">
              Mandamiento
            </button>
    </div>
    
    <button class="btn btn-primary btn-generate" type="submit" (click)="onSubmit()">
      Generar <span class="fw-bold">{{ tipoSalida == 1 ? 'Cédula' : 'Mandamiento' }}</span>
    </button>
  </div>
</div>

<!-- ################################################################################ -->
